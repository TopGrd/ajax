!function(){function toJson(text){var json;try{json="object"==typeof JSON&&"function"==typeof JSON.parse?JSON.parse(text):eval(text)}catch(e){}return json}function extend(t,e){if("[object Object]"===Object.prototype.toString.call(t)&&"[object Object]"===Object.prototype.toString.call(e))for(var o in e)t[o]=e[o];return t}window.ajax=function(t){function e(){var t=!1;try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(o){t=!1}}return t||"undefined"==typeof XMLHttpRequest||(t=new XMLHttpRequest),t}function o(t,e,o,r,s){var a=t.xhr;r=n(r,s),t.options.cache||(o+=(-1==o.indexOf("?")?"?":"&")+"t="+(new Date).getTime()),"get"===e&&(o+=(-1==o.indexOf("?")?"?":"&")+r),c(a),a.open(e,o,t.options.async),"post"===e&&r?(a.setRequestHeader("Content-Type",t.postContentType),a.send(r)):a.send()}function n(t,e){return"[object Object]"===Object.prototype.toString.call(t)?"json"===e.toLowerCase()&&"object"==typeof JSON&&"function"==typeof JSON.stringify?(a.postContentType="application/json",JSON.stringify(t)):(a.postContentType="application/x-www-form-urlencoded",r(t)):void 0}function r(t){if("[object Object]"==Object.prototype.toString.call(t)){var e=[];for(var o in t){var n=t[o];if("[object Array]"==Object.prototype.toString.call(n))for(var r=0;r<n.length;++r)e.push(o+"="+encodeURIComponent(n[r]));else e.push(o+"="+encodeURIComponent(t[o]))}}return e.join("&")}function c(t){t.onreadystatechange=function(){if(4==t.readyState){var e,o;for(e=0,o=a.alwaysCallbacks.length;o>e;e++)a.alwaysCallbacks[e](t.status,t.responseText,t);var n=t.responseText,r=toJson(n);if(200==t.status)if(a.jsonForceValidate&&"undefined"==typeof r)for(e=0,o=a.errorCallbacks.length;o>e;e++)a.errorCallbacks[e](t.status,t.responseText,t);else for(e=0,o=a.successCallbacks.length;o>e;e++)a.successCallbacks[e](r||n,t);else for(e=0,o=a.errorCallbacks.length;o>e;e++)a.errorCallbacks[e](t.status,t.responseText,t)}}}var s={async:!0,cache:!1};t=extend(s,t);var a={xhr:e(),successCallbacks:[],errorCallbacks:[],alwaysCallbacks:[],options:t};return a.before=function(t){return"function"==typeof t&&t(a.xhr),a},a.header=function(t,e){return a.xhr.setRequestHeader(t,e),a},a.headers=function(t){if("[object object]"===Object.prototype.toString.call(t))for(var e in t)a.xhr.setRequestHeader(e,t[e])},a.success=function(t,e){return a.jsonForceValidate=e,"function"==typeof t&&a.successCallbacks.push(t),a},a.error=function(t){return"function"==typeof t&&a.errorCallbacks.push(t),a},a.always=function(t){return"function"==typeof t&&a.alwaysCallbacks.push(t),a},a.timeout=function(t,e){return a.xhr.timeout=t,"function"==typeof e&&(a.xhr.timeout=function(){e(a.xhr)}),a},a.post=function(t,e,n){if("undefined"==typeof t)throw"url不能为空";return"[object Object]"!==Object.prototype.toString.call(e)&&(e=void 0),"string"!=typeof n&&(n="urlencoded"),o(a,"post",t,e,n),a},a.get=function(t,e){if("undefined"==typeof t)throw"url不能为空";return"[object Object]"!==Object.prototype.toString.call(e)&&(e=void 0),o(a,"get",t,e,"urlencoded"),a},a}}();